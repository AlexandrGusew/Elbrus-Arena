# Frontend - Dark Fantasy Game (Telegram Mini App)

## 1. Технологический стек

### Core
- **Framework**: React 18 + TypeScript
- **State Management**: Redux Toolkit / Zustand
- **Routing**: React Router v6
- **Styling**: Tailwind CSS + Radix UI
- **Animations**: Framer Motion

### Интеграции
- **Telegram**: @twa-dev/sdk
- **WebSocket**: Socket.io-client
- **HTTP**: Axios
- **Forms**: React Hook Form + Zod

### Dev Tools
- **Build**: Vite
- **Linting**: ESLint + Prettier
- **Testing**: Vitest + React Testing Library

## 2. Архитектура приложения

### 2.1 Структура проекта
```
src/
├── app/              # Главные компоненты приложения
├── pages/            # Страницы/экраны
├── components/       # Переиспользуемые компоненты
├── features/         # Фичи (Redux slices + компоненты)
├── hooks/            # Custom hooks
├── services/         # API и внешние сервисы
├── store/            # Redux store
├── utils/            # Утилиты
├── styles/           # Глобальные стили
└── types/            # TypeScript типы
```

### 2.2 State Management
- **Global State** (Redux):
  - Данные пользователя и персонажа
  - Текущий бой
  - Инвентарь
  - Настройки игры
  
- **Local State** (useState/useReducer):
  - UI состояния (модалки, лоадеры)
  - Формы
  - Временные данные

## 3. Основные экраны

## 4. UI/UX концепция

### 4.1 Визуальный стиль
**Dark Fantasy тема:**
- Темная цветовая палитра
- Готические элементы
- Металлические и кожаные текстуры
- Эффекты огня и свечения

**Цвета:**
- Фон: темно-серый/черный
- Акценты: красный, золотой
- HP: зеленый
- Мана/энергия: синий

### 4.2 Адаптивность
- Mobile-first дизайн
- Поддержка разных размеров экранов
- Оптимизация для Telegram окна
- Крупные кнопки для тач-управления

### 4.3 Анимации
- Плавные переходы между экранами
- Анимации атак в боях
- Эффекты при получении наград
- Микроанимации интерфейса

### 3.2 Создание персонажа
**Элементы:**
- Ввод имени персонажа
- Выбор класса (воин/убийца/маг)
- Описание особенностей класса
- Предпросмотр стартовых характеристик

**Функционал:**
- Валидация имени
- Подсветка различий между классами
- Анимированный выбор

### 3.1 Главное ЭКРАН
**Элементы:**
- Информация о персонаже (аватар, уровень, HP)
- Индикатор стамины
- Баланс золота
- Кнопки навигации к основным разделам

**Функционал:**
- Быстрый доступ к PvE/PvP
- Отображение важных уведомлений
- Быстрые действия (зелье, способность)

### 3.3 Профиль персонажа
**Элементы:**
- Класс и уровень
- Основные характеристики
- Свободные очки для распределения
- Статистика боев
- Прогресс до следующего уровня

**Функционал:**
- Распределение очков характеристик
- Сброс характеристик за золото
- История последних боев

### 3.5 PVE - Выбор данжа
**Элементы:**
- Список доступных данжей
- Индикатор сложности
- Требования (уровень, стамина)
- Предпросмотр возможных наград

**Функционал:**
- Фильтр по сложности
- Проверка доступности
- Информация о боссе

### 3.6 PvP - арена
**Элементы:**
- Кнопка поиска противника
- Текущий рейтинг
- Статистика побед/поражений
- Анимация поиска

**Функционал:**
- Поиск противника (до 30 сек)
- Отмена поиска
- Уведомление о найденном противнике

### 3.4 Экран боя (PvE/PvP)
**Элементы:**
- HP бары участников
- Таймер хода (10 секунд)
- Зоны атаки и защиты
- Кнопки способности и зелья
- Лог боя

**Функционал:**
- Выбор 2 зон атаки
- Выбор 3 зон защиты
- Использование способности/зелья (не тратит ход)
- Анимации ударов и блоков
- Всплывающие числа урона

- Начало/конец боя

### 3.7 Инвентарь
**Элементы:**
- Слоты экипировки (5 слотов)
- Сетка предметов в рюкзаке
- Информация о предмете
- Сравнение характеристик

**Функционал:**
- Drag & Drop для экипировки
- Сравнение с текущей экипировкой
- Продажа предметов
- Фильтр по типу/редкости

### 3.8 Магазин
**Элементы:**
- Список товаров
- Цены в золоте
- Требования предметов
- Баланс игрока

**Функционал:**
- Покупка предметов
- Проверка требований
- Подсветка доступных товаров

### 3.9 Кузнец
**Элементы:**
- Выбор предмета для заточки
- Текущий уровень заточки
- Шанс успеха (30%)
- Стоимость улучшения

**Функционал:**
- Заточка от +1 до +10
- Анимация процесса заточки
- Результат (успех/неудача)

### 3.10 Таблица лидеров
**Элементы:**
- Топ-10 игроков
- Позиция текущего игрока
- Рейтинг, класс, уровень

**Функционал:**
- Автообновление
- Подсветка своей позиции
- Просмотр профилей других игроков


## 5. Интеграция с Telegram

### 5.1 Telegram Web App SDK
**Использование:**
- InitData для авторизации
- MainButton для основных действий
- BackButton для навигации
- HapticFeedback для обратной связи
- ThemeParams для адаптации цветов

### 5.2 Особенности
- Автоматическая тема (светлая/темная)
- Использование Telegram аватаров
- Inline клавиатура для быстрых действий
- Свайпы для навигации

## 6. WebSocket взаимодействие

### 6.1 Реальное время
**События:**
- Подключение к бою
- Отправка действий
- Получение результатов раунда
- Синхронизация состояния

### 6.2 Обработка разрывов
- Автоматическое переподключение
- Сохранение состояния
- Индикатор соединения

## 7. Оптимизация производительности

### 7.1 Bundle size
- Code splitting по роутам
- Lazy loading компонентов
- Tree shaking
- Минификация

### 7.2 Runtime
- React.memo для тяжелых компонентов
- useMemo/useCallback
- Виртуализация списков
- Оптимизация ререндеров

### 7.3 Загрузка
- Progressive loading
- Скелетоны вместо спиннеров
- Оптимистичные обновления
- Предзагрузка данных

## 8. Обработка ошибок

### 8.1 Сетевые ошибки
- Retry механизм
- Fallback UI
- Оффлайн режим для статики
- Информативные сообщения

### 8.2 Валидация
- Клиентская валидация форм
- Проверка действий в бою
- Предупреждения о неверных действиях

## 9. Звуки и музыка

### 9.1 Звуковые эффекты
- Удары по разным зонам
- Блокирование
- Критический удар
- Использование способности
- Получение награды
- UI звуки (клики, переходы)

### 9.2 Управление
- Вкл/выкл звука
- Регулировка громкости
- Сохранение настроек

## 10. Локализация

### 10.1 Языки
- Русский (основной)
- Английский (в будущем)

### 10.2 Система
- i18n библиотека
- Автоопределение из Telegram
- Переключение языка

## 11. Аналитика

### 11.1 События
- Старт игры
- Создание персонажа
- Начало/конец боя
- Покупки в магазине
- Использование способностей
